---
title: "API Reference"
subtitle: "Complete Function Signatures and Usage Examples"
---

## Overview

This section provides complete API documentation for the Ramanujan CRDT Network, including all major components:

- **CRDT API** - Conflict-free data type operations
- **E-Graph API** - Equality graph construction and saturation
- **Agent API** - Multi-agent coordination

## Quick Reference

### CRDT Operations

| Type | Operation | Signature | Returns |
|------|-----------|-----------|---------|
| TextCRDT | insert | `insert(pos, text)` | `TextCRDT` |
| TextCRDT | delete | `delete(pos, length)` | `TextCRDT` |
| TextCRDT | merge | `merge(other)` | `TextCRDT` |
| JSONCRDT | set | `set(path, value)` | `JSONCRDT` |
| JSONCRDT | merge | `merge(other)` | `JSONCRDT` |
| GCounter | increment | `increment(agent_id)` | `GCounter` |
| GCounter | value | `value()` | `i64` |
| ORSet | add | `add(element)` | `ORSet` |
| ORSet | remove | `remove(element)` | `ORSet` |
| ORSet | contains | `contains(element)` | `bool` |

### Agent Operations

| Operation | Signature | Returns |
|-----------|-----------|---------|
| Process | `process(msg: Message)` | `Vec<Message>` |
| Commit | `commitment()` | `[u8; 32]` |
| Recover | `recover(snapshot: &[u8])` | `Result<()>` |
| Status | `status()` | `AgentStatus` |

### Coordination Operations

| Operation | Signature | Purpose |
|-----------|-----------|---------|
| Publish | `publish(op, doc_id, payload)` | Send message to agent |
| Subscribe | `subscribe(subject_pattern)` | Receive matching messages |
| Coordinate Merge | `coordinate_merge(doc_id)` | Execute distributed merge |
| Vector Clock Merge | `vector_clock.merge(other)` | Synchronize causality |

## Section Details

- **[CRDT API](crdt-api.qmd)** - Detailed CRDT function documentation
- **[E-Graph API](egraph-api.qmd)** - E-graph construction and saturation
- **[Agent API](agent-api.qmd)** - Multi-agent system operations

## Common Usage Patterns

### Creating and Merging CRDTs

```rust
// Create TextCRDT
let mut doc1 = TextCRDT::new();
doc1.insert(0, "Hello");

let mut doc2 = TextCRDT::new();
doc2.insert(0, "Hello");

// Merge (commutative!)
let merged = doc1.merge(&doc2);  // Same as doc2.merge(&doc1)
```

### Multi-Agent Coordination

```rust
// Agent 0: Insert operation
coordinator.publish(
    operation: :insert,
    document_id: "doc_42",
    payload: { text: "hello" },
    agent_id: 0
);

// Agent 1: Merge operation
coordinator.publish(
    operation: :merge,
    document_id: "doc_42",
    payload: {},
    agent_id: 1
);

// All agents: Coordinate merge
coordinator.coordinate_merge("doc_42");
```

### E-Graph Verification

```rust
// Build e-graph from CRDT operations
let mut egraph = EGraph::new();
egraph.add_node(expr1);
egraph.add_node(expr2);

// Apply rewrite rules
for rule in &rules {
    rule.apply(&mut egraph);
}

// Saturate to fixpoint
let result = egraph.saturate();

// Verify properties
assert!(result.iterations < 20);  // Converged quickly
assert_eq!(result.color_violations, 0);  // Valid coloring
```

## Error Handling

Standard error types:

```rust
pub enum CRDTError {
    SerializationError(String),
    VectorClockError(String),
    CacheError(String),
    MergeConflict(String),
}
```

All operations return `Result<T, CRDTError>` with detailed error messages.

## Performance Guidelines

### Caching Strategy
- TextCRDT merge: <1ms (cached) or 10-20ms (computed)
- JSONCRDT merge: <1ms (cached) or 15-25ms (computed)
- GCounter increment: <100μs

### Throughput Targets
- Per-agent: 10K+ ops/sec
- Total (9 agents): 90K+ ops/sec (actual: 221K)
- E-graph saturation: 1K+ rewrites/iteration

### Memory Usage
- Per-agent vector clock: 72 bytes (9 agents × 8 bytes)
- Fingerprint cache: 8 bytes per cached entry
- E-graph overhead: ~5% above raw data

## Version Compatibility

**Current Version:** 1.0.0

**WASM Targets Supported:**
- Fermyon Spin 3.5.1+
- Bartholomew 1.0+
- Rhai 1.15+
- Guile 3.0+ with Hoot
- Goblins 0.2+
- Wasmcloud 0.50+
- QASM 1.0+

## Next Steps

For detailed API documentation:
- **[CRDT API Details](crdt-api.qmd)**
- **[E-Graph API Details](egraph-api.qmd)**
- **[Agent API Details](agent-api.qmd)**

For deployment:
- **[Deployment Checklist](../deployment/checklist.qmd)**

For examples:
- See code repository at `https://github.com/topos-institute/ramanujan-crdt`
